<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN">
<html>
<head>
<meta http-equiv="Content-Type" content="text/html;charset=iso-8859-1">
<meta name="copyright" content="Karl N. Redman 2004">
<meta name="keywords" content="run-free,GUI,command line launcher,application,xfree86,bash_history">
<meta name="description" content="run-free is a GUI command line lauching application for Xwindows">
<TITLE>run-free: GUI Command Line Launcher</TITLE>
<LINK HREF="doxygen.css" REL="stylesheet" TYPE="text/css">
</head>
<BODY BGCOLOR="#FFFFFF">
<font size="-3">
<center>
<table>
<tr>
	<td><a href="http://run-free.sourceforge.net" target="top">Project Homepage</a></td>
	<td><a href="http://sourceforge.net/projects/run-free/" target="top">Sourceforge Page</a></td>
	<td><a href="http://cvs.sourceforge.net/viewcvs.py/run-free/" target="top">CVS Repository</a></td>
	<td><a href="http://freshmeat.net/projects/run-free/" target="top">Freshmeat.net Page</a></td>
	<td><a href="http://sourceforge.net/project/showfiles.php?group_id=39135&package_id=31325" target="top">Download project</a></td>
	<td><a href="http://www.sleepingstill.com" target="top">Author's Homepage</a></td>
</tr>
</table>
</center>
</font>
<hr>
<!-- Generated by Doxygen 1.3.5 -->
<div class="qindex">  <form class="search" action="search.php" method="get">
<a class="qindex" href="main.html">Main&nbsp;Page</a> | <a class="qindex" href="files.html">File&nbsp;List</a> | <a class="qindex" href="globals.html">Globals</a> | <a class="qindex" href="pages.html">Related&nbsp;Pages</a>  | <span class="search"><u>S</u>earch&nbsp;for&nbsp;<input class="search" type="text" name="query" value="" size="20" accesskey="s"/></span></form></div>
<h1>comboHandlers.h File Reference</h1><hr><a name="_details"></a><h2>Detailed Description</h2>
various handlers based on comboBox data 
<p>
<dl compact><dt><b>Note:</b></dt><dd>This stuff will be moved to more appropriate files in the near future.</dd></dl>

<p>
Definition in file <a class="el" href="comboHandlers_8h-source.html">comboHandlers.h</a>.
<p>

<p>
This graph shows which files directly or indirectly include this file:<p><center><img src="comboHandlers_8h__dep__incl.png" border="0" usemap="#comboHandlers.hdep_map" alt="Included by dependency graph"></center>
<map name="comboHandlers.hdep_map">
<area href="callbacks_8c.html" shape="rect" coords="7,17,84,36" alt="">
<area href="comboBox_8c.html" shape="rect" coords="108,17,191,36" alt="">
<area href="comboHandlers_8c.html" shape="rect" coords="215,17,327,36" alt="">
<area href="main_8c.html" shape="rect" coords="351,17,399,36" alt="">
</map>

<p>
<a href="comboHandlers_8h-source.html">Go to the source code of this file.</a><table border=0 cellpadding=0 cellspacing=0>
<tr><td></td></tr>
<tr><td colspan=2><br><h2>command line lengths</h2></td></tr>
<tr><td colspan=2>Figure out the maximum command line lengths for the current shell <br><br></td></tr>
<tr><td class="memItemLeft" nowrap align=right valign=top>#define&nbsp;</td><td class="memItemRight" valign=bottom><a class="el" href="comboHandlers_8h.html#a0">RF_LINE_MAX_LEN</a>&nbsp;&nbsp;&nbsp;255</td></tr>

<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">use a standard line length  <a href="#a0"></a><br><br></td></tr>
<tr><td colspan=2><br><h2>Functions</h2></td></tr>
<tr><td class="memItemLeft" nowrap align=right valign=top>void&nbsp;</td><td class="memItemRight" valign=bottom><a class="el" href="comboHandlers_8h.html#a1">freeList</a> (GList *list)</td></tr>

<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">free a GList object and all it's members  <a href="#a1"></a><br><br></td></tr>
<tr><td class="memItemLeft" nowrap align=right valign=top>GList *&nbsp;</td><td class="memItemRight" valign=bottom><a class="el" href="comboHandlers_8h.html#a2">readHistory</a> (GList *list, char *filename)</td></tr>

<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">read a history file  <a href="#a2"></a><br><br></td></tr>
<tr><td class="memItemLeft" nowrap align=right valign=top>int&nbsp;</td><td class="memItemRight" valign=bottom><a class="el" href="comboHandlers_8h.html#a3">writeHistory</a> (char *<a class="el" href="main_8h.html#a8">command</a>, char *filename)</td></tr>

<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">write to a history file (append)  <a href="#a3"></a><br><br></td></tr>
</table>
<hr><h2>Define Documentation</h2>
<a class="anchor" name="a0" doxytag="comboHandlers.h::RF_LINE_MAX_LEN" ></a><p>
<table class="mdTable" width="100%" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top"> #define RF_LINE_MAX_LEN&nbsp;&nbsp;&nbsp;255
      </table>
    </td>
  </tr>
</table>
<table cellspacing=5 cellpadding=0 border=0>
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>
use a standard line length 
<p>

<p>
Definition at line <a class="el" href="comboHandlers_8h-source.html#l00045">45</a> of file <a class="el" href="comboHandlers_8h-source.html">comboHandlers.h</a>.
<p>
Referenced by <a class="el" href="comboHandlers_8c-source.html#l00057">readHistory()</a>.    </td>
  </tr>
</table>
<hr><h2>Function Documentation</h2>
<a class="anchor" name="a1" doxytag="comboHandlers.h::freeList" ></a><p>
<table class="mdTable" width="100%" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top"> void freeList </td>
          <td class="md" valign="top">(&nbsp;</td>
          <td class="md" nowrap valign="top">GList *&nbsp;</td>
          <td class="mdname1" valign="top" nowrap> <em>list</em>          </td>
          <td class="md" valign="top">&nbsp;)&nbsp;</td>
          <td class="md" nowrap></td>
        </tr>

      </table>
    </td>
  </tr>
</table>
<table cellspacing=5 cellpadding=0 border=0>
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>
free a GList object and all it's members 
<p>
<dl compact><dt><b>Author:</b></dt><dd>Karl N. Redman</dd></dl>
<dl compact><dt><b>Parameters:</b></dt><dd>
  <table border="0" cellspacing="2" cellpadding="0">
    <tr><td valign=top><em>list</em>&nbsp;</td><td>A pointer to a GList to be freed</td></tr>
  </table>
</dl>
<dl compact><dt><b>Purpose:</b></dt><dd>Frees the points in the GList and then the GList pointer itself. </dd></dl>

<p>
Definition at line <a class="el" href="comboHandlers_8c-source.html#l00173">173</a> of file <a class="el" href="comboHandlers_8c-source.html">comboHandlers.c</a>.
<p>
Referenced by <a class="el" href="main_8c-source.html#l00078">main()</a>, and <a class="el" href="callbacks_8c-source.html#l00058">on_mainWindow_destroy()</a>.
<p>
<div class="fragment"><pre>00174 {
00175   <span class="keywordtype">int</span> i =0;
00176   <span class="keywordflow">for</span>(; i &lt; (<span class="keywordtype">int</span>)g_list_length(list); i++, list = list-&gt;next)
00177     free(list-&gt;data);
00178   
00179   g_list_free(list);
00180 }
</pre></div>    </td>
  </tr>
</table>
<a class="anchor" name="a2" doxytag="comboHandlers.h::readHistory" ></a><p>
<table class="mdTable" width="100%" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top"> GList* readHistory </td>
          <td class="md" valign="top">(&nbsp;</td>
          <td class="md" nowrap valign="top">GList *&nbsp;</td>
          <td class="mdname" nowrap> <em>list</em>, </td>
        </tr>
        <tr>
          <td></td>
          <td></td>
          <td class="md" nowrap>char *&nbsp;</td>
          <td class="mdname" nowrap> <em>filename</em></td>
        </tr>
        <tr>
          <td></td>
          <td class="md">)&nbsp;</td>
          <td class="md" colspan="2"></td>
        </tr>

      </table>
    </td>
  </tr>
</table>
<table cellspacing=5 cellpadding=0 border=0>
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>
read a history file 
<p>
<dl compact><dt><b>Author:</b></dt><dd>Karl N. Redman</dd></dl>
<dl compact><dt><b>Parameters:</b></dt><dd>
  <table border="0" cellspacing="2" cellpadding="0">
    <tr><td valign=top><em>list</em>&nbsp;</td><td>A list to populate (must be NULL) -probably superfluious. </td></tr>
    <tr><td valign=top><em>filename</em>&nbsp;</td><td>The filename of the file to read from</td></tr>
  </table>
</dl>
<dl compact><dt><b>Returns:</b></dt><dd>A populated GList.</dd></dl>
<dl compact><dt><b>Purpose:</b></dt><dd>Read a history file and populate a GList with it's data. The list is populated in reverse of the file contents to accomidate for (only) a file that is appended to. </dd></dl>

<p>
<dl compact><dt><b>Warning:</b></dt><dd>This caused alot of headeache. In the first place, gtk GList operations are not intuitive at all. In the end it was discovered that, because the values of the glist are pointers, that we must use a persistant glist to populate our target glist. What this means is that we end up passing in and returning the same pointer (not the same address) in order to properly populate our GList.</dd></dl>
<p>
<dl compact><dt><b><a class="el" href="todo.html#_todo000003">Todo:</a></b></dt><dd>we are not handling file operations properly here -I was probably tired and lazy at the time. This MUST be fixed in the near future! </dd></dl>

<p>
Definition at line <a class="el" href="comboHandlers_8c-source.html#l00057">57</a> of file <a class="el" href="comboHandlers_8c-source.html">comboHandlers.c</a>.
<p>
References <a class="el" href="debug_8h-source.html#l00075">dprint</a>, <a class="el" href="main_8h-source.html#l00050">history_len</a>, and <a class="el" href="comboHandlers_8h-source.html#l00045">RF_LINE_MAX_LEN</a>.
<p>
Referenced by <a class="el" href="comboBox_8c-source.html#l00044">combo_init()</a>.
<p>
<div class="fragment"><pre>00058 {
00059   FILE *fp;
00060 <span class="comment"></span>
00061 <span class="comment">  /** \warning This caused alot of headeache. In the first place, gtk</span>
00062 <span class="comment">    GList operations are not intuitive at all. In the end it was</span>
00063 <span class="comment">    discovered that, because the values of the glist are pointers,</span>
00064 <span class="comment">    that we must use a persistant glist to populate our target</span>
00065 <span class="comment">    glist. What this means is that we end up passing in and returning</span>
00066 <span class="comment">    the same pointer (not the same address) in order to properly</span>
00067 <span class="comment">    populate our GList.</span>
00068 <span class="comment">  */</span>
00069 
00070   <span class="comment">//grab the environment $HOME directory</span>
00071   <span class="comment">//TODO</span>
00072   <span class="keywordflow">if</span>( (fp = fopen(filename, <span class="stringliteral">"a+"</span>) ) == NULL)
00073     {
00074       <a class="code" href="debug_8h.html#a3">dprint</a>(<span class="stringliteral">"run-free: bash_history file not found"</span>);
00075       <span class="comment"></span>
00076 <span class="comment">      /**\todo</span>
00077 <span class="comment">         we are not handling file operations properly here -I was</span>
00078 <span class="comment">         probably tired and lazy at the time. This MUST be fixed in</span>
00079 <span class="comment">         the near future!</span>
00080 <span class="comment">       */</span>
00081 
00082       <span class="comment">//ok, try a different file</span>
00083       <span class="comment">//TODO</span>
00084       <span class="comment">//else pop up a dialog</span>
00085     }
00086 
00087   <span class="comment">//max line length is the system max (this could be huge!)</span>
00088   <span class="keywordtype">char</span> line[<a class="code" href="comboHandlers_8h.html#a0">RF_LINE_MAX_LEN</a>+1];
00089   <span class="keywordtype">int</span> c;
00090   <span class="keywordtype">int</span> i =0, numItems =0;
00091   <span class="comment">//char *string;</span>
00092 
00093   memset(line, <span class="charliteral">'\0'</span>, <span class="keyword">sizeof</span>(line));
00094 
00095   <span class="keywordflow">do</span>
00096     {
00097       <span class="keywordflow">if</span>( (c = fgetc(fp)) == EOF)
00098         {
00099           <span class="comment">//dprint("end of file\n");</span>
00100           <span class="keywordflow">break</span>;
00101         }
00102       <span class="keywordflow">if</span>(c != <span class="charliteral">'\n'</span>)
00103         {
00104           line[i] = c;
00105           i++;
00106           <span class="keywordflow">continue</span>;
00107         }
00108       <span class="keywordflow">else</span>
00109         {
00110           i=0;
00111           <span class="keywordflow">if</span>(strcmp(line, <span class="stringliteral">"\n"</span>) == 0)
00112             {
00113               memset(line, <span class="charliteral">'\0'</span>, <span class="keyword">sizeof</span>(line));
00114               <span class="keywordflow">continue</span>;
00115             }
00116         }
00117 
00118       list = g_list_prepend(list, strdup(line));
00119       numItems++;
00120 
00121       memset(line, <span class="charliteral">'\0'</span>, <span class="keyword">sizeof</span>(line));
00122     }<span class="keywordflow">while</span>(1);
00123 
00124   fclose(fp);
00125 
00126   <span class="comment">//list = g_list_reverse(list);</span>
00127 
00128   <span class="comment">//eliminate duplicates</span>
00129   GList *newList = NULL;
00130 
00131   i=0;
00132 
00133   <span class="comment">//this is how we set the combo box length</span>
00134   <span class="comment">//int loop_num = RF_MAX_HISTLIST_LEN-1;</span>
00135   <span class="keywordtype">int</span> loop_num = <a class="code" href="main_8h.html#a6">history_len</a> -1;
00136 
00137   
00138   <span class="comment">//weed out duplicates and only keep the first instance of a history</span>
00139   <span class="comment">//line</span>
00140   <span class="keywordflow">for</span>(;i &lt; loop_num &amp;&amp; (list != NULL); i++, 
00141         list = g_list_next(list))
00142         {
00143 
00144           <span class="comment">//see if we've seen this one before</span>
00145            <span class="keywordflow">if</span>(g_list_find_custom(newList, list-&gt;data,
00146                                  (GCompareFunc)strcmp) == NULL) 
00147             {
00148               <span class="comment">//put the old command in the combo box</span>
00149               newList = g_list_append(newList, (<span class="keywordtype">char</span> *)list-&gt;data);
00150             }
00151            <span class="keywordflow">else</span>
00152              {
00153                <span class="comment">//increase the number of loops we're going to try and</span>
00154                <span class="comment">// grab the next one (unless NULL happens on next)</span>
00155                ++loop_num;
00156              }
00157         }<span class="comment">//end for</span>
00158 
00159   newList = g_list_prepend(newList, <span class="stringliteral">""</span>);
00160   <span class="keywordflow">return</span>(newList);
00161 }
</pre></div>    </td>
  </tr>
</table>
<a class="anchor" name="a3" doxytag="comboHandlers.h::writeHistory" ></a><p>
<table class="mdTable" width="100%" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top"> int writeHistory </td>
          <td class="md" valign="top">(&nbsp;</td>
          <td class="md" nowrap valign="top">char *&nbsp;</td>
          <td class="mdname" nowrap> <em>command</em>, </td>
        </tr>
        <tr>
          <td></td>
          <td></td>
          <td class="md" nowrap>char *&nbsp;</td>
          <td class="mdname" nowrap> <em>filename</em></td>
        </tr>
        <tr>
          <td></td>
          <td class="md">)&nbsp;</td>
          <td class="md" colspan="2"></td>
        </tr>

      </table>
    </td>
  </tr>
</table>
<table cellspacing=5 cellpadding=0 border=0>
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>
write to a history file (append) 
<p>
<dl compact><dt><b>Author:</b></dt><dd>Karl N. Redman</dd></dl>
<dl compact><dt><b>Parameters:</b></dt><dd>
  <table border="0" cellspacing="2" cellpadding="0">
    <tr><td valign=top><em>command</em>&nbsp;</td><td>the command to append to the file </td></tr>
    <tr><td valign=top><em>filename</em>&nbsp;</td><td>the file to append the command to</td></tr>
  </table>
</dl>
<dl compact><dt><b></b></dt><dd>Purpose: Appends the command to the end of the file </dd></dl>

<p>
<dl compact><dt><b><a class="el" href="todo.html#_todo000004">Todo:</a></b></dt><dd>FIX THIS I'm not handling file operations properly -probably tired at the time... -parasyte. </dd></dl>

<p>
Definition at line <a class="el" href="comboHandlers_8c-source.html#l00195">195</a> of file <a class="el" href="comboHandlers_8c-source.html">comboHandlers.c</a>.
<p>
References <a class="el" href="main_8h-source.html#l00054">command</a>.
<p>
Referenced by <a class="el" href="callbacks_8c-source.html#l00099">on_combo_entry1_key_press_event()</a>, <a class="el" href="callbacks_8c-source.html#l00352">on_runButton_clicked()</a>, and <a class="el" href="main_8c-source.html#l00380">run_command()</a>.
<p>
<div class="fragment"><pre>00196 {
00197   <span class="comment">//always writes to the end of the file</span>
00198 
00199   FILE *fp;
00200   <span class="keywordtype">int</span> retval = 0;
00201   <span class="keywordtype">int</span> wLen = 0;
00202 
00203   
00204   fp = fopen(filename, <span class="stringliteral">"a+"</span>);
00205   <span class="keywordflow">if</span>(fp == NULL)
00206     {<span class="comment"></span>
00207 <span class="comment">      /**\todo FIX THIS I'm not handling file operations properly</span>
00208 <span class="comment">      -probably tired at the time... -parasyte.</span>
00209 <span class="comment">      */</span>
00210       <span class="comment">//display dialog</span>
00211     }
00212 
00213   <span class="comment">//write command line to file</span>
00214   <span class="keywordflow">if</span>((wLen = fputs(command, fp)) &gt; 0)
00215     {
00216       retval = -1;
00217     }
00218   <span class="comment">//else write a new line</span>
00219    fputs(<span class="stringliteral">"\n"</span>, fp);
00220 
00221   fclose(fp);                   <span class="comment">// close file</span>
00222 
00223   <span class="keywordflow">return</span> retval;
00224 }
</pre></div>    </td>
  </tr>
</table>
<hr size="1"><address style="align: right;"><small>Generated on Wed Mar 17 14:38:22 2004 for run-free by
<a href="http://www.doxygen.org/index.html">
<img src="doxygen.png" alt="doxygen" align="middle" border=0 > 
</a>1.3.5 </small></address>
</body>
</html>
